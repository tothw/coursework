\documentclass[letterpaper,12pt,oneside,onecolumn]{article}
\usepackage[margin=1in, bottom=1in, top=1in]{geometry} %1 inch margins
\usepackage{amsmath, amssymb, amstext}
\usepackage{fancyhdr}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{mathtools}

\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}

%Macros
\newcommand{\A}{\mathbb{A}} \newcommand{\C}{\mathbb{C}}
\newcommand{\D}{\mathbb{D}} \newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathbb{N}} \newcommand{\R}{\mathbb{R}}
\newcommand{\T}{\mathbb{T}} \newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
 
 
\newcommand{\cA}{\mathcal{A}} \newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}} \newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}} \newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}} \newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}} \newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}} \newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}} \newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}} \newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}} \newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}} \newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}} \newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}} \newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}} \newcommand{\cZ}{\mathcal{Z}}

%Page style
\pagestyle{fancy}

\listfiles

\raggedbottom

\rhead{William Justin Toth 685 A5} %CHANGE n to ASSIGNMENT NUMBER ijk TO COURSE CODE
\renewcommand{\headrulewidth}{1pt} %heading underlined
%\renewcommand{\baselinestretch}{1.2} % 1.2 line spacing for legibility (optional)

\begin{document}
\section*{6.43}
\paragraph{}
Let $E$ be the elliptic curve $E: y^2 = x^3 + 1$ over a field $K$. Suppose that $K$ contains an element $\beta \neq 1$ satisfying $\beta^3 = 1$. Let $\phi$ be a map given by $\phi(x,y) = (\beta x, y)$ and $\phi(\infty) = \infty$.
\subsection*{a}
Let $P \in E(K)$. If $P = \infty$ then $\phi(P) = \infty \in E(K)$ as desired. So we may assume $P=(x,y) \neq \infty$. Then $x, y \in K$ and $(x,y) \in E$. Now $\phi(P) = \phi(x,y) = (\beta x, y)$. Since $(x,y) \in E$, \begin{align} y^2 = x^3 + 1. \end{align} Now 
\begin{align*}
(\beta x)^3 + 1 &= \beta^3 x^3 + 1 \\
&= x^3 + 1 &\text{since $\beta$ is a primitive cube root of unity}\\
&= y^2. &\text{by $(1)$}
\end{align*}
Thus $(\beta x, y) \in E$. Now since $\beta \in K$, $x \in K$ and $K$ is a field, $\beta x \in K$. Since $\beta x \in K$ and $y \in K$, and $(\beta x, y) \in E$ we have that $(\beta x, y) \in E(K)$. $\blacksquare$
\subsection*{b}
\paragraph{}
Let $P_1, P_2 \in E(K)$. Suppose $P_1 = \infty$ or $P_2 = \infty$. Say without loss generality that $P_1 = \infty$ (if $P_2 = \infty$ and $P_1 \neq \infty$ relabel subscripts). Then $\phi(P_1 + P_2) = \phi(\infty + P_2) = \phi(P_2)$, and $\phi(P_1) + \phi(P_2) = \phi(\infty) + \phi(P_2) = \infty + \phi(P_2) = \phi(P_2)$. Thus $\phi(P_1 + P_2) = \phi(P_1) + \phi(P_2)$.
\paragraph{}
Now suppose that $P_1 \neq \infty$ and $P_2 \neq \infty$. Say $P_1 = (x_1, y_1)$ and $P_2 = (x_2, y_2)$. To compute $P_1 + P_2$ we use the computational formula. Let:
\begin{align*}
m = \begin{cases}
\frac{y_2 - y_1}{x_2 - x_1}, &\text{if $P_1 \neq P_2$}\\
\frac{3x_1^2}{2y_1}, &\text{if $P_1 = P_2$}
\end{cases}
\end{align*}
Then $P_1 + P_2 = (x_3, y_3)$ where $x_3 = m^2 - x_1 - x_2$ and $y_3 = m(x_1 - x_3) - y_1$. Similarly we will use the computational formula to compute $(\beta x_1, y_1) + (\beta x_2, y_2)$. Let:
\begin{align*}
m_{\beta} = \begin{cases}
\frac{y_2 - y_2}{\beta(x_2 - x_1)}, &\text{if $P_1 \neq P_2$} \\
\frac{3\beta^2x_1^2}{2y_1}, &\text{if $P_1 = P_2$}
\end{cases}\end{align*}
Then $(\beta x_1, y_1) + (\beta x_2, y_2) = (m_\beta^2 - \beta x_1 - \beta x_2, m_\beta(\beta x_1 - (m_\beta^2 - \beta x_1 - \beta x_2)) -y_1)$.
\paragraph{Claim 1.1}
$m_\beta^2= \beta m^2$.
\paragraph{Proof of Claim 1.1}
If $P_1 \neq P_2$ then
\begin{align}
m_\beta^2 &= \frac{(y_2 - y_1)^2}{\beta^2(x_2-x_1)^2} \nonumber\\
&= \frac{\beta(y_2 - y_1)^2}{\beta^3(x_2-x_1)^2} \nonumber\\
&= \beta\frac{(y_2 - y_1)^2}{(x_2-x_1)^2} &\text{since $\beta^3 = 1$}\nonumber\\
&= \beta m^2.\nonumber
\end{align}
Similarly if $P_1 = P_2$ then
\begin{align*}
m_\beta^2 &= \frac{3^2 \beta^4 x_1^4}{2^2y_1^2} \\
&= \beta\frac{3^2\beta^3x_1^4}{2^2y_1^2} \\
&= \beta\frac{3^2x_1^4}{2^2y_1^2} &\text{since $\beta^3 = 1$}\\
&= \beta m^2.
\end{align*}
Thus in either case $m_\beta^2 = \beta m^2$ and hence the claim holds. $\blacksquare$
\paragraph{Claim 1.2}
$\beta m_\beta = m$.
\paragraph{Proof of Claim 1.2}
If $P_1 \neq P_2$ then
\begin{align*}
\beta m_\beta &= \beta\frac{y_2 - y_1}{\beta(x_2 - x_1)} \\
&= \frac{y_2 - y_1}{(x_2 - x_1)} \\
&= m.
\end{align*}
Similarly if $P_1 = P_2$ then
\begin{align*}
\beta m_\beta &= \beta \frac{3\beta^2 x_1^2}{2y_1^2} \\
&= \frac{3\beta^3 x_1^2}{2y_1^2} \\
&= \frac{3 x_1^2}{2y_1^2} &\text{since $\beta^3 = 1$}\\
&= m.
\end{align*}
Thus in either case $\beta m_\beta = m$ and hence the claim holds. $\blacksquare$
\paragraph{}
Now we have:
\begin{align}
\phi(P_1 + P_2) &= \phi(x_3, y_3) \nonumber\\
&= (\beta x_3, y_3)
\end{align}
Further we have:
\begin{align}
\phi(P_1) + \phi(P_2) &= (\beta x_1, y_1) + (\beta x_2, y_2) \nonumber \\
&= (m_\beta^2 - \beta x_1 - \beta x_2,m_\beta(\beta x_1 - (m_\beta^2 - \beta x_1 - \beta x_2)) -y_1) \nonumber \\
&= (\beta m^2 - \beta x_1 - \beta x_2, m_\beta(\beta x_1 - (m_\beta^2 - \beta x_1 - \beta x_2)) -y_1) &\text{by Claim $1.1$} \nonumber \\
&= (\beta x_3,m_\beta(\beta x_1 - (m_\beta^2 - \beta x_1 - \beta x_2)) -y_1) \nonumber \\
&= (\beta x_3, m_\beta(2\beta x_1 + \beta x_2 - m_\beta^2) - y_1) \nonumber \\
&= (\beta x_3, m_\beta(2\beta x_1 + \beta x_2 - \beta m^2) - y_1) &\text{by Claim $1.1$} \nonumber\\
&= (\beta x_3, \beta m_\beta(x_1 - (m^2 - x_1 -x_2)) - y_1) \nonumber\\
&= (\beta x_3, \beta m_\beta(x_1 - x_3) - y_1) \nonumber\\
&= (\beta x_3, m(x_1 - x_3) - y_1) &\text{by Claim $1.2$} \nonumber\\
&= (\beta x_3, y_3) 
\end{align}
Combining $(2)$ and $(3)$ we see that $\phi(P_1 + P_2) = \phi(P_1) + \phi(P_2)$ as desired. $\blacksquare$

\section*{6.49}
\paragraph{}
Consider the cryptosystem described in Table $6.12$ of the textbook. For convenience it is reproduced below:
\paragraph{Public Parameters}
A trusted authority Tom publishes a finite field $\F_q$, an elliptic curve $E/\F_q$, a point $P \in E(\F_q)[l]$ of prime order $l$, and an $l$-distortion map $\phi$ for $P$. Tom also chooses two hash functions: $H_1 : \{$IDs$\} \rightarrow E(\F_q)[l]$, and $H_2:\F_q^* \rightarrow \{0,1\}^B$.
\paragraph{Master Key Creation}
Tom chooses a secret integer $s$ modulo $l$. Tom publishes the point $P^{\text{Tom}} = sP \in E(\F_q)[l]$.
\paragraph{Private Key Extraction}
Alice chooses an ID-based public key $\text{Alice}^{\text{Pub}}$. Tom computes the point $P^{\text{Alice}} = H_1(\text{Alice}^{\text{Pub}}) \in E(\F_q)[l]$. Tom sends the point $Q^{\text{Alice}} = sP^{\text{Alice}} \in E(\F_q)[l]$ to Alice.
\paragraph{Encryption}
Bob chooses a plaintext $M$ and a random number $r$ modulo $q-1$. Bob computes the point $P^{\text{Alice}} = H_1(\text{Alice}^{\text{Pub}}) \in E(\F_q)[l]$. Bob's ciphertext is the pair $$ (C_1,C_2) = (rP, M \text{ xor } H_2(\hat{e}_l(P^{\text{Alice}}, P^{\text{Tom}})^r)).$$
\paragraph{Decryption}
Alice decrypts the ciphertext $(C_1, C_2)$ by computing $$C_2 \text{ xor } H_2(\hat{e}_l(Q^{\text{Alice}}, C_1)).$$
\subsection*{a}
\paragraph{}
Suppose that Eve can solve the discrete logarithm in $E(\F_q)$. Then Eve can use the published point $P \in E(\F_q)[l] \subseteq E(\F_q)$, and Tom's public point $P^{\text{Tom}} = sP \in E(\F_q)[l] \subseteq E(\F_q)$, and solve the discrete logarithm with these two inputs to obtain Tom's secret key $s$.
\paragraph{}
Now suppose instead that Eve can solve the discrete logarithm problem in $\F_q^*$. Since Eve has access to $l$ and $\phi$ she has access to the function $\hat{e}_l$ who's codomain is $\F_q^*$. Then Eve can use the public points $P^\text{Alice}, P^{\text{Tom}} \in E(\F_q)[l]$ to compute $\hat{e}_l(P^\text{Alice}, P^{\text{Tom}}) \in \F_q^*$. Since $P^{\text{Tom}} = sP$ we have that 
\begin{align*}
\hat{e}_l(P^\text{Alice}, P^{\text{Tom}}) &= e_l(P^\text{Alice}, \phi(sP))\\
&= e_l(P^\text{Alice}, s\phi(P)) &\text{by property $(i)$ of $\phi$} \\
&= e_l(P^\text{Alice},\phi(P))^s. &\text{by bilinearity of $e_l$}
\end{align*}
Thus Alice can solve the discrete logarith with inputs $\hat{e}_l(P^\text{Alice},\phi(P))$ (entirely computable with public information), and $\hat{e}_l(P^\text{Alice}, P^{\text{Tom}})$ to obtain $s$. $\blacksquare$
\subsection*{b}
\paragraph{}
Suppose that Eve knows how to solve the elliptic curve Diffie-Hellman problem in $E(\F_q)$. That is for any $P \in E(\F_q)$, Eve can find $n_1n_2P$ given $n_1P$ and $n_2P$. Let $(C_1, C_2)$ be any ciphertext. Let $r$ be a random number modulo $q-1$ such that $C_1 = rP$. Then we have that:
\begin{align*}
\hat{e}_l (Q^\text{Alice}, C_1) &= e_l(sP^\text{Alice}, \phi(rP)) \\
&= e_l(sP^\text{Alice}, r\phi(P)) &\text{by property $(i)$ of $\phi$}\\
&=e_l(P^\text{Alice}, \phi(P))^{sr} &\text{by bilinearity of $e_l$}\\
&=e_l(P^\text{Alice},sr\phi(P)) &\text{by bilinearity of $e_l$}\\
&=e_l(P^\text{Alice},\phi(srP)). &\text{by property $(i)$ of $\phi$}
\end{align*}
Since $P \in E(\F_q)$, and Eve knows $P$, $sP = P^\text{Tom}$, and $rP = C_1$, Eve can solve the elliptic curve Diffie-Hellman problem to obtain $srP$.
\paragraph{}
With $srP$ in hand, Eve can compute $e_l(P^\text{Alice},\phi(srP))$ and thus by equality Eve has the value of $\hat{e}_l (Q^\text{Alice}, C_1)$. Now Eve can decrypt by computing $C_2 \text{ xor } H_2(\hat{e}_l(Q^{\text{Alice}}, C_1))$. $\blacksquare$
\subsection*{c}
\paragraph{}
Suppose that Eve knows how to solve the Diffie-Hellman problem in $\F_q^*$. Let $(C_1, C_2)$ be any ciphertext. Let $r$ be a random number modulo $q-1$ such that $C_1 = rP$. Then we have that:
\begin{align*}
\hat{e}_l(P^\text{Alice}, C_1) &= e_l(P^\text{Alice}, \phi(rP)) \\
&= e_l(P^\text{Alice}, r\phi(P)) &\text{by property $(i)$ of $\phi$}\\
&= e_l(P^\text{Alice}, \phi(P))^r &\text{by bilinearity of $e_l$}. \\
\end{align*}
We also have that:
\begin{align*}
\hat{e}_l(P^\text{Alice}, P^\text{Tom}) &= e_l(P^\text{Alice}, \phi(sP)) \\
&= e_l(P^\text{Alice}, s\phi(P)) &\text{by property $(i)$ of $\phi$}\\
&= e_l(P^\text{Alice}, \phi(P))^s &\text{by bilinearity of $e_l$}. \\
\end{align*}
Thus Alice can solve the Diffie-Hellman problem in $\F_q^*$ on the inputs $\hat{e}_l(P^\text{Alice}, P)$, $\hat{e}_l(P^\text{Alice}, P^\text{Tom})$, and $\hat{e}_l(P^\text{Alice}, C_1)$ to obtain $e_l(P^\text{Alice}, \phi(P))^{sr}$. By our previous calculation in $(b)$ this is equal to $\hat{e}_l(Q^\text{Alice},C_1)$. Now Eve can decrypt by computing $C_2 \text{ xor } H_2(\hat{e}_l(Q^{\text{Alice}}, C_1))$. $\blacksquare$
\section*{Problem 3}
\subsection*{a}
\paragraph{}
Consider the cryptosystem as described in the previous problem. Define the hash function $H_1: \text{IDs} \rightarrow E(\F_q)[l]$ as follows. Let $H' : \{0,1\}^* \rightarrow \{1,\dots, l-1\}$. To compute $H_1(ID)$ convert $ID$ to a binary string $\beta$, compute $H'(\beta) = m_\beta$, and output $m_\beta P$. This function is insecure when used in the cryptosystem as $H_1$ is public information, implicit in which is that $H'$ is public information. Notice that if $H'$ is not publicly published, but $H_1$ is, then access to $H'$ can be simulated by monitoring the execution of $H_1$ until it computes $H'(\beta) = m_\beta$ and extracting this value as if you had access to $H'$. Thus Eve can compute the binary representation of $\text{Alice}^\text{Pub} = \beta$, and use the function $H'$ to compute $H'(\beta) = m_\beta$ such that $P^\text{Alice} = m_\beta P$.
\paragraph{}
Let $(C_1,C_2)$ be any ciphertext sent to Alice. Then Eve can compute:
\begin{align*}
\hat{e}_l(P^\text{Tom}, C_1)^{m_\beta} &= e_l(sP, \phi(rP))^{m_\beta} \\
&= e_l(m_\beta sP, \phi(rP)) \\
&= \hat{e}_l(Q^\text{Alice}, C_1).
\end{align*}
Therefore  Eve can compute $C_2\text{ xor } H_2(\hat{e}_l(P^\text{Tom}, C_1)^{m_\beta})$ which is equal to $C_2\text{ xor } H_2(\hat{e}_l(Q^\text{Alice}, C_1))$ which is equal to $m$ by the decryption algorithm. Thus Eve can decrypt any ciphertext. $\blacksquare$
\subsection*{b}
\paragraph{}
Modify the hash function $H_1$ from part $a$ as follows. Choose a random point $Q \in E(\F_q)[l]$ such that $Q \neq P$. Instead of outputting $m_\beta P$ as in the previous hash function, output $m_\beta Q$. A note should be made in the cryptosystem that when Tom chooses his secret, $s$, he should verify that $sP \neq Q$ to help prevent the previous attack.
\paragraph{}
Let $(C_1, C_2)$ be any ciphertext sent to Alice. For Eve to decrypt, it boils down to Eve being able to compute $\hat{e}_l(Q^\text{Alice}, C_1)$ without knowing $Q^\text{Alice}$. The information Eve has access to is $m, Q, mQ = P^\text{Alice}, P, sP=P^\text{Tom}$, and $rP = C_1$. Now $Q^\text{Alice} = smQ$, so $\hat{e}_l(Q^\text{Alice}, C_1) = \hat{e}_l(Q, P)^{smr}$. Now assuming Eve cannot solve ECDH, DLOG, BDH implies that her only computationally feasible option for computing $\hat{e}_l(Q,P)^{smr}$ is to compute the pairing of $\hat{e}_l(mQ, sP)^r$ or $\hat{e}_l(mQ, rP)^s$. But Eve knows neither $s$ nor $r$, and cannot find them without solving DLOG. Clearly the knowledge of $m$ does not help Eve, as computing $hat{e}_l(rP, sP)^m$ as in the previous attack gets Eve nowhere because $Q$ was excluded from the pairing. Thus this hash function doesn't emit the same attack as the previous hash function, and doesn't offer any clear new security vulnerabilities. $\blacksquare$
\end{document}
